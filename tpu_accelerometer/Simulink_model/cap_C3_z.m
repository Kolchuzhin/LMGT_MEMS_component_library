function fr=cap_C3_z(q1,q2,q3,key)
%=========================================================================%
% PURPOSE:
%
%           capacitance evaluation C3_z(0,0,q3)
%           q3=[-4.9...+4.9] um
%
% DEPENDENCIES:
%
%               ROMOPER.m
%-------------------------------------------------------------------------%
% by Kolchuzhin V.A., Munich, 2016-05-20
% <vladimir.kolchuzhin@ieee.org>
%-------------------------------------------------------------------------%
% Revision History:
% 2016-05-27 initial release
%=========================================================================%
%------------
% uMKSV unit
%------------
% [displacement] m-->um
% [capacitance]  F-->pF
% [free space permittivity] pF/um
%=========================================================================%
eps_0=8.854e-6;     % permittivity, pF/um
%-------------------------------------------------------------------------%
% data
PCOE=[-8.3886e-005 0.00047093 -0.0017236 0.12844 0.6067];
ORDER=[0 0 4];
FUN=1;
TYPE=2;
%-------------------------------------------------------------------------%
if nargin==0 % self-test: C(0,0,0)=1.6483 pF
    q1=0.0; q2=0.0; q3=0.0; % x z y
    key=1;
end
%-------------------------------------------------------------------------%
fr=[];
[F,dF,ddF]=ROMOPER([0.0 0.0 q3],PCOE,ORDER,FUN,TYPE);
  
if key==1 fr=F; end                  %  capacitance
if key==2 fr=[0.0; 0.0; dF(3);]; end % dcapacitance (~electostatic force)
%-------------------------------------------------------------------------%
return
